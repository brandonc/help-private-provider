## Create & Upload a Private Provider (Sorta)

This is half-automated, half [do-nothing](https://blog.danslimmon.com/2019/07/15/do-nothing-scripting-the-key-to-gradual-automation") set of scripts to assist in uploading a single linux platform provider to a private registry in Terraform Cloud.

### Prerequisite Assets

1. A pgp signing key which is used to sign the provider you want to register. You can generate a signing key using [these instructions](https://developer.hashicorp.com/terraform/tutorials/providers-plugin-framework/providers-plugin-framework-release-publish#generate-gpg-signing-key). The public key should be exported in ASCII-armor format.

2. The linux/amd64 provider binary, SHA256SUMS, and SHA256SUMS.sig files. These are usually generated by goreleaser. I find it easy to generate these on Github Actions using the [scaffolding workflow](https://github.com/hashicorp/terraform-provider-scaffolding-framework/blob/main/.github/workflows/release.yml) configured with the exported secret key from prerequisite 1.

### Steps:

Visit each directory in order and perform the following instructions.

##### 01-gpg-key

Copy your exported public signing key to `01-gpg-key/my_key.pgp` and `terraform init` / `terraform apply` to create the key on the private registry.

Now would be a good time to edit `config_example` and copy to `.secret_config`. Make sure you also copy the Key ID terraform output into KEY_ID.

`$ cp config_example .secret_config`

##### 02-provider-create

Run `./script.sh` and follow the instructions

##### 03-version-create

Run `./script.sh` and follow the instructions

##### 04-provider-sha

Run `./script.sh` and follow the instructions

##### 05-platform-upload

Run `./script.sh <SHA256SUM>` and follow the instructions
